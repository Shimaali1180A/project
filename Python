!pip install tensorflow==2.12.0
# ğŸ“¦ Ø§Ø³ØªÙŠØ±Ø§Ø¯ Ø§Ù„Ù…ÙƒØªØ¨Ø§Øª
from tensorflow.keras.models import load_model
from PIL import Image
import numpy as np

# âœ… ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù†Ù…ÙˆØ°Ø¬ Ø§Ù„Ù…Ø¯Ø±Ø¨
model = load_model("keras_model.h5", compile=False)

# âœ… ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØªØµÙ†ÙŠÙØ§Øª (labels)
labels = open("labels.txt", "r").read().splitlines()

# âœ… ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØµÙˆØ±Ø© ÙˆØªØ­ÙˆÙŠÙ„Ù‡Ø§ Ø¥Ù„Ù‰ RGB
image = Image.open("Lion.jpg").convert("RGB")

# âœ… ØªØºÙŠÙŠØ± Ø­Ø¬Ù… Ø§Ù„ØµÙˆØ±Ø© Ù„ØªØªÙ†Ø§Ø³Ø¨ Ù…Ø¹ Ø§Ù„Ù†Ù…ÙˆØ°Ø¬ (224x224)
image = image.resize((224, 224))

# âœ… ØªØ­ÙˆÙŠÙ„ Ø§Ù„ØµÙˆØ±Ø© Ø¥Ù„Ù‰ Ù…ØµÙÙˆÙØ© Ø£Ø±Ù‚Ø§Ù… ÙˆØªØ·Ø¨ÙŠØ¹ Ø§Ù„Ù‚ÙŠÙ…
image_array = np.array(image).astype(np.float32)
image_array = (image_array / 127.5) - 1
image_array = np.expand_dims(image_array, axis=0)  # Ø§Ù„Ø´ÙƒÙ„ Ø§Ù„Ù…Ø·Ù„ÙˆØ¨: (1, 224, 224, 3)

# âœ… ØªÙ†ÙÙŠØ° Ø§Ù„ØªÙ†Ø¨Ø¤
prediction = model.predict(image_array)
index = np.argmax(prediction)
confidence = prediction[0][index]

# âœ… Ø·Ø¨Ø§Ø¹Ø© Ø§Ù„Ù†ØªÙŠØ¬Ø©
print("âœ… Ø§Ù„ØµÙˆØ±Ø©: Lion.jpg")
print("â†ªï¸ Ø§Ù„ØªØµÙ†ÙŠÙ:", labels[index])
print("â†ªï¸ Ù†Ø³Ø¨Ø© Ø§Ù„Ø«Ù‚Ø©:", round(confidence * 100, 2), "%")
